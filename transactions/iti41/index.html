<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Quentin Ligier"><link href=https://qligier.github.io/cara-emed-ig/transactions/iti41/ rel=canonical><link href=../auth/ rel=prev><link href=../iti43/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.5.3, mkdocs-material-9.0.15"><title>XDS: publish documents (ITI-41) - CARA's eMedication IG</title><link rel=stylesheet href=../../assets/stylesheets/main.113286f1.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.a0c5b2b5.min.css><link rel=stylesheet href=../../css/timeago.css><link rel=stylesheet href=../../stylesheets/cara.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=blue data-md-color-accent> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#iti-41 class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="CARA's eMedication IG" class="md-header__button md-logo" aria-label="CARA's eMedication IG" data-md-component=logo> <img src=../../assets/cara.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> CARA's eMedication IG </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> XDS: publish documents (ITI-41) </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=blue data-md-color-accent aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=blue data-md-color-accent aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> </form> <div class=md-header__source> <a href=https://github.com/qligier/cara-emed-ig title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../ class="md-tabs__link md-tabs__link--active"> Transactions </a> </li> <li class=md-tabs__item> <a href=../../emed/ class=md-tabs__link> CH-EMED-EPR </a> </li> <li class=md-tabs__item> <a href=../../appc/ class=md-tabs__link> PMP-APPC </a> </li> <li class=md-tabs__item> <a href=../../endpoints/ class=md-tabs__link> EndPoints </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="CARA's eMedication IG" class="md-nav__button md-logo" aria-label="CARA's eMedication IG" data-md-component=logo> <img src=../../assets/cara.svg alt=logo> </a> CARA's eMedication IG </label> <div class=md-nav__source> <a href=https://github.com/qligier/cara-emed-ig title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <div class="md-nav__link md-nav__link--index "> <a href=../ >Transactions</a> <label for=__nav_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Transactions </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../documents/ class=md-nav__link> Documents </a> </li> <li class=md-nav__item> <a href=../auth/ class=md-nav__link> Auth </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> XDS: publish documents (ITI-41) <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> XDS: publish documents (ITI-41) </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#publishing-documents class=md-nav__link> Publishing documents </a> <nav class=md-nav aria-label="Publishing documents"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#document-types class=md-nav__link> Document types </a> </li> <li class=md-nav__item> <a href=#submissionset-and-relations class=md-nav__link> SubmissionSet and relations </a> </li> <li class=md-nav__item> <a href=#uniqueness class=md-nav__link> Uniqueness </a> </li> <li class=md-nav__item> <a href=#metadata class=md-nav__link> Metadata </a> <nav class=md-nav aria-label=Metadata> <ul class=md-nav__list> <li class=md-nav__item> <a href=#submissionset-metadata class=md-nav__link> SubmissionSet metadata </a> </li> <li class=md-nav__item> <a href=#documententry-metadata class=md-nav__link> DocumentEntry metadata </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#publishing-a-ch-emed-epr-document class=md-nav__link> Publishing a CH-EMED-EPR document </a> <nav class=md-nav aria-label="Publishing a CH-EMED-EPR document"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#referencing-external-documents class=md-nav__link> Referencing external documents </a> </li> <li class=md-nav__item> <a href=#creation-times class=md-nav__link> Creation times </a> </li> <li class=md-nav__item> <a href=#rules-for-each-type-of-document class=md-nav__link> Rules for each type of document </a> <nav class=md-nav aria-label="Rules for each type of document"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#pre class=md-nav__link> PRE </a> </li> <li class=md-nav__item> <a href=#padv class=md-nav__link> PADV </a> <nav class=md-nav aria-label=PADV> <ul class=md-nav__list> <li class=md-nav__item> <a href=#padv-against-a-provisional-pre class=md-nav__link> PADV against a provisional PRE </a> </li> <li class=md-nav__item> <a href=#padv-cancel class=md-nav__link> PADV CANCEL </a> <nav class=md-nav aria-label="PADV CANCEL"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#against-mtp class=md-nav__link> Against MTP </a> </li> <li class=md-nav__item> <a href=#against-pre class=md-nav__link> Against PRE </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#padv-ok class=md-nav__link> PADV OK </a> </li> <li class=md-nav__item> <a href=#padv-change class=md-nav__link> PADV CHANGE </a> <nav class=md-nav aria-label="PADV CHANGE"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#against-mtp_1 class=md-nav__link> Against MTP </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#against-pre_1 class=md-nav__link> Against PRE </a> </li> <li class=md-nav__item> <a href=#padv-refuse class=md-nav__link> PADV REFUSE </a> <nav class=md-nav aria-label="PADV REFUSE"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#against-mtp_2 class=md-nav__link> Against MTP </a> </li> <li class=md-nav__item> <a href=#against-pre_2 class=md-nav__link> Against PRE </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#padv-suspend class=md-nav__link> PADV SUSPEND </a> </li> <li class=md-nav__item> <a href=#padv-comment class=md-nav__link> PADV COMMENT: </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#dis class=md-nav__link> DIS </a> <nav class=md-nav aria-label=DIS> <ul class=md-nav__list> <li class=md-nav__item> <a href=#dis-against-mtp-or-pre-mtp class=md-nav__link> DIS against MTP or PRE + MTP: </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#roles class=md-nav__link> Roles </a> </li> <li class=md-nav__item> <a href=#metadata-values-check class=md-nav__link> Metadata values check </a> </li> <li class=md-nav__item> <a href=#classcode-metadata-to-use-for-each-document-type class=md-nav__link> ClassCode metadata to use for each document type </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#replacing-a-ch-emed-epr-document class=md-nav__link> Replacing a CH-EMED-EPR document </a> </li> <li class=md-nav__item> <a href=#publishing-a-pmp-appc-document class=md-nav__link> Publishing a PMP-APPC document </a> <nav class=md-nav aria-label="Publishing a PMP-APPC document"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#rules-for-appc class=md-nav__link> Rules for APPC: </a> </li> <li class=md-nav__item> <a href=#appc-metadata class=md-nav__link> APPC metadata </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../iti43/ class=md-nav__link> XDS: retrieve documents (ITI-43) </a> </li> <li class=md-nav__item> <a href=../iti18/ class=md-nav__link> XDS: search documents (ITI-18) </a> </li> <li class=md-nav__item> <a href=../iti57/ class=md-nav__link> XDS: delete documents (ITI-57) </a> </li> <li class=md-nav__item> <a href=../chpharm1/ class=md-nav__link> XDS: search pharmacy documents (CH:PHARM-1) </a> </li> <li class=md-nav__item> <a href=../date_processing/ class=md-nav__link> Date processing </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../emed/ class=md-nav__link> CH-EMED-EPR </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <div class="md-nav__link md-nav__link--index "> <a href=../../appc/ >PMP-APPC</a> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> PMP-APPC </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> EndPoints <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> EndPoints </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../endpoints/ class=md-nav__link> Endpoints </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=iti-41>ITI-41</h1> <p>The <a href=https://profiles.ihe.net/ITI/TF/Volume2/ITI-41.html>ITI-41 (Provide and Register Document Set-b)</a> transaction allows a <a href=https://profiles.ihe.net/ITI/TF/Volume2/ITI-41.html#3.41.2>content sender</a> to send documents to the eMedication service (<a href=https://profiles.ihe.net/ITI/TF/Volume2/ITI-41.html#3.41.2>content receiver</a>). </p> <p>Generic <a href=https://profiles.ihe.net/ITI/TF/Volume3/ch-4.2.html#4.2.1.1>DocumentEntry metadata</a> are described in the <a href=../documents/ >documents section</a>. This page references additional constraints specific to ITI-41. See also IHE&rsquo;s documentation for <a href=https://profiles.ihe.net/ITI/TF/Volume3/index.html>metadata in Document Sharing profiles</a>.</p> <h2 id=publishing-documents>Publishing documents</h2> <h3 id=document-types>Document types</h3> <p>Two types of documents might be published to the service : - <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/ >CH-EMED-EPR</a> documents (<a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/document_mtp.html>MTP</a>, <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/document_pre.html>PRE</a>, <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/document_dis.html>DIS</a> and <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/document_padv.html>PADV</a> only, <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/document_pml.html>PML</a> and <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/document_pmlc.html>PMLC</a> can only be retrieved from the service and not published to it). These documents contain the eMedication data. See also the <a href=../../emed/ >corresponding page</a> in this guide. - <a href=https://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_APPC.pdf>APPC (Advanced Patient Privacy Consent)</a> documents. These documents are used to let patients define access rights to their data (who can publish and retrieve their data). See also the <a href=../../appc/ >corresponding page</a> in this guide.</p> <h3 id=submissionset-and-relations>SubmissionSet and relations</h3> <p>The eMedication service does not support folders and can only receive ONE document at a time. Hence, the <a href=https://profiles.ihe.net/ITI/TF/Volume3/ch-4.1.html#4.1>metadata</a> must always contain a <a href=https://profiles.ihe.net/ITI/TF/Volume3/ch-4.1.html#4.1.1.1>SubmissionSet</a> with a single <a href=https://profiles.ihe.net/ITI/TF/Volume3/ch-4.1.html#4.1.1.3>DocumentEntry</a>.</p> <p>Only the following <a href=https://profiles.ihe.net/ITI/TF/Volume3/ch-4.1.html#4.1.2>associations</a> are supported :</p> <table> <thead> <tr> <th>Association Type</th> <th>Usage</th> </tr> </thead> <tbody> <tr> <td><a href=https://profiles.ihe.net/ITI/TF/Volume3/ch-4.2.html#4.2.2.1.1>urn:oasis:names:tc:ebxml-regrep:AssociationType:HasMember</a></td> <td><a href=https://profiles.ihe.net/ITI/TF/Volume3/ch-4.1.html#4.1.2.1>To link a DocumentEntry to the SubmissionSet</a>.</td> </tr> <tr> <td><a href=https://profiles.ihe.net/ITI/TF/Volume3/ch-4.2.html#t4.2.2-1>urn:ihe:iti:2007:AssociationType:RPLC</a></td> <td><a href=https://profiles.ihe.net/ITI/TF/Volume3/ch-4.1.html#4.1.2.2>To replace a previously published document</a>. Replaced document becomes deprecated.</td> </tr> </tbody> </table> <h3 id=uniqueness>Uniqueness</h3> <p>Documents can be sent to the eMedication service only once. Uniqueness is checked against <a href=https://profiles.ihe.net/ITI/TF/Volume3/ch-4.2.html#4.2.3.2.26>DocumentEntry&rsquo;s unique Id</a>, that must be an UUID and <a href=https://profiles.ihe.net/ITI/TF/Volume3/ch-4.2.html#4.2.3.2.7>DocumentEntry&rsquo;s entryUUID</a>.</p> <h3 id=metadata>Metadata</h3> <p>This section describes the rules applicable for any document&rsquo;s type metadata.</p> <h4 id=submissionset-metadata>SubmissionSet metadata</h4> <p>See also the <a href=https://profiles.ihe.net/ITI/TF/Volume3/ch-4.2.html#4.2.1.2>SubmissionSet Metadata Attributes diagram</a>.</p> <table> <thead> <tr> <th>Metadata</th> <th>Opt</th> <th>Rules</th> </tr> </thead> <tbody> <tr> <td><code>uniqueId</code></td> <td>R</td> <td>Must be a UUID. Can be used only once and must be globally unique.</td> </tr> <tr> <td><code>author</code></td> <td>R</td> <td>Multiple values accepted.</td> </tr> <tr> <td><code>author.authorRole</code></td> <td>R</td> <td>Possible values are defined in <a href=http://fhir.ch/ig/ch-epr-term/2.0.9/ValueSet-DocumentEntry.authorRole.html>ch-epr-term IG</a>. For APPC, only <code>PAT</code> (patient) and <code>REP</code> (Representative) are allowed.</td> </tr> <tr> <td><code>author.authorSpecialty</code></td> <td>O</td> <td>Possible values are defined in <a href=http://fhir.ch/ig/ch-epr-term/2.0.9/ValueSet-DocumentEntry.authorSpeciality.html>ch-epr-term IG</a>.</td> </tr> <tr> <td><code>availabilityStatus</code></td> <td>O</td> <td>The value set in the metadata is always ignored, and replaced by <code>approved</code>.</td> </tr> <tr> <td><code>comments</code></td> <td>O</td> <td>-</td> </tr> <tr> <td><code>contentTypeCode</code></td> <td>R</td> <td>Possible values are defined in <a href=http://fhir.ch/ig/ch-epr-term/2.0.9/ValueSet-DocumentEntry.mimeType.html>ch-epr-term IG</a>. Use <code>application/fhir+json</code> or <code>application/fhir+xml</code> for CH-EMED-EPR documents, and <code>text/xml</code> for APPC.</td> </tr> <tr> <td><code>entryUUID</code></td> <td>R</td> <td>Must be globally unique.</td> </tr> <tr> <td><code>homeCommunityId</code></td> <td>O</td> <td>Not used. Can be left blank or omitted.</td> </tr> <tr> <td><code>intendedRecipient</code></td> <td>O</td> <td>Not used. Can be left blank or omitted.</td> </tr> <tr> <td><code>limitedMetadata</code></td> <td>O</td> <td>Must be left bank or omitted.</td> </tr> <tr> <td><code>patientId</code></td> <td>R</td> <td>Must be a XAD-PID.</td> </tr> <tr> <td><code>sourceId</code></td> <td>R</td> <td>Globally unique and immutable OID identifier of the source.</td> </tr> <tr> <td><code>submissionTime</code></td> <td>R</td> <td><a href=http://www.hl7.eu/refactored/dtDTM.html>HL7 DTM</a> value in UTC.</td> </tr> <tr> <td><code>title</code></td> <td>O</td> <td>-</td> </tr> </tbody> </table> <h4 id=documententry-metadata>DocumentEntry metadata</h4> <p>See also the <a href=https://profiles.ihe.net/ITI/TF/Volume3/ch-4.2.html#4.2.1.1>DocumentEntry Metadata Attributes diagram</a>.</p> <table> <thead> <tr> <th>Metadata</th> <th>Opt</th> <th>Rules</th> </tr> </thead> <tbody> <tr> <td><code>author.authorRole</code></td> <td>R</td> <td>Possible values are defined in <a href=http://fhir.ch/ig/ch-epr-term/2.0.9/ValueSet-DocumentEntry.authorRole.html>ch-epr-term IG</a>. For APPC, only <code>PAT</code> (patient) and <code>REP</code> (Representative) are allowed. Must be aligned with document content author (<a href=#Metadata-values-check>see below</a>).</td> </tr> <tr> <td><code>author.authorSpecialty</code></td> <td>O</td> <td>Possible values are defined in <a href=http://fhir.ch/ig/ch-epr-term/2.0.9/ValueSet-DocumentEntry.authorSpeciality.html>ch-epr-term IG</a>. Must be aligned with document content author (<a href=#Metadata-values-check>see below</a>).</td> </tr> <tr> <td><code>availabilityStatus</code></td> <td>O</td> <td>The value set in the metadata is always ignored, and replaced by <code>approved</code>.</td> </tr> <tr> <td><code>classCode</code></td> <td>R</td> <td>See <a href=#ClassCode-metadata-to-use-for-each-document-type>CH-EMED-EPR</a> and <a href=#Publishing-a-PMP-APPC-document>APPC</a> sections below.</td> </tr> <tr> <td><code>comments</code></td> <td>O</td> <td>-</td> </tr> <tr> <td><code>confidentialityCode</code></td> <td>R</td> <td><a href=https://profiles.ihe.net/ITI/TF/Volume3/ch-4.2.html#4.2.3.2.5>Confidentiality level</a> in the DocumentEntry metadata is forced to <a href=http://fhir.ch/ig/ch-epr-term/2.0.9/ValueSet-DocumentEntry.confidentialityCode.html><code>Normal</code></a>.</td> </tr> <tr> <td><code>creationTime</code></td> <td>R</td> <td><a href=http://www.hl7.eu/refactored/dtDTM.html>HL7 DTM</a> value in UTC. Must match document content creation time (<a href=#Metadata-values-check>see below</a>).</td> </tr> <tr> <td><code>deletionStatus</code></td> <td>O</td> <td>If present, deletionStatus must be <code>urn:e-health-suisse:2019:deletionStatus:deletionNotRequested</code>.</td> </tr> <tr> <td><code>documentAvailability</code></td> <td>O</td> <td>If present should be <code>Online</code>.</td> </tr> <tr> <td><code>entryUUID</code></td> <td>R</td> <td>Must be globally unique.</td> </tr> <tr> <td><code>eventCodeList</code></td> <td>O</td> <td>See the <a href=http://fhir.ch/ig/ch-epr-term/2.0.9/ValueSet-DocumentEntry.eventCodeList.html>list of available codes</a>.</td> </tr> <tr> <td><code>formatCode</code></td> <td>R</td> <td>See <a href=#ClassCode-metadata-to-use-for-each-document-type>CH-EMED-EPR</a> and <a href=#Publishing-a-PMP-APPC-document>APPC</a> sections below.</td> </tr> <tr> <td><code>hash</code></td> <td>O</td> <td>Hash of the document content.</td> </tr> <tr> <td><code>healthcareFacilityTypeCode</code></td> <td>R</td> <td>See the <a href=http://fhir.ch/ig/ch-epr-term/2.0.9/ValueSet-DocumentEntry.healthcareFacilityTypeCode.html>list of available codes</a>.</td> </tr> <tr> <td><code>homeCommunityId</code></td> <td>O</td> <td>-</td> </tr> <tr> <td><code>languageCode</code></td> <td>R</td> <td>See the <a href=http://fhir.ch/ig/ch-epr-term/2.0.9/ValueSet-DocumentEntry.languageCode.html>list of available codes</a>.</td> </tr> <tr> <td><code>legalAuthenticator</code></td> <td>O</td> <td>-</td> </tr> <tr> <td><code>limitedMetadata</code></td> <td>O</td> <td>Must be left bank or omitted.</td> </tr> <tr> <td><code>logicalId</code></td> <td>O</td> <td>Shall be present when replacing a document.</td> </tr> <tr> <td><code>mimeType</code></td> <td>O</td> <td>Possible values are defined <a href=http://fhir.ch/ig/ch-epr-term/2.0.9/ValueSet-DocumentEntry.mimeType.html>ch-epr-term IG</a>. Use <code>application/fhir+json</code> or <code>application/fhir+xml</code> for CH-EMED-EPR documents, and <code>text/xml</code> for APPC.</td> </tr> <tr> <td><code>objectType</code></td> <td>R</td> <td>Value is ignored and set to <code>Stable</code>.</td> </tr> <tr> <td><code>patientId</code></td> <td>R</td> <td>Must match <code>SubmissionSet.patientId</code> and be a XAD-PID (<a href=#SubmissionSet-metadata>see above</a>).</td> </tr> <tr> <td><code>practiceSettingCode</code></td> <td>R</td> <td>See the <a href=http://fhir.ch/ig/ch-epr-term/2.0.9/ValueSet-DocumentEntry.practiceSettingCode.html>list of available codes</a>.</td> </tr> <tr> <td><code>referenceIdList</code></td> <td>O</td> <td>Must be omitted or empty as referencing external documents is not permitted (see <a href=#Referencing-external-documents>Referencing external documents</a> section).</td> </tr> <tr> <td><code>repositoryUniqueId</code></td> <td>O</td> <td>If the attribute <code>repositoryUniqueId</code> is present and does not correspond to the <code>repositoryUniqueId</code> containing the documents the request is refused.</td> </tr> <tr> <td><code>serviceStartTime</code></td> <td>O</td> <td>Given as an <a href=http://www.hl7.eu/refactored/dtDTM.html>HL7 DTM</a> in UTC. Shall be empty for APPC</td> </tr> <tr> <td><code>serviceStopTime</code></td> <td>O</td> <td>Given as an <a href=http://www.hl7.eu/refactored/dtDTM.html>HL7 DTM</a> in UTC. Shall be empty for APPC</td> </tr> <tr> <td><code>size</code></td> <td>O</td> <td>-</td> </tr> <tr> <td><code>sourcePatientId</code></td> <td>R</td> <td>Any id known or unknown to the local MPI. EPR-SPID and SSN are forbidden.</td> </tr> <tr> <td><code>sourcePatientInfo</code></td> <td>O</td> <td>Ignored by the service.</td> </tr> <tr> <td><code>title</code></td> <td>R</td> <td>-</td> </tr> <tr> <td><code>typeCode</code></td> <td>R</td> <td>See <a href=#ClassCode-metadata-to-use-for-each-document-type>section</a> below.</td> </tr> <tr> <td><code>uniqueId</code></td> <td>R</td> <td>Must be globally unique and be a UUID. Must match the document id in the case of CH-EMED-EPR documents.</td> </tr> <tr> <td><code>URI</code></td> <td>O</td> <td>-</td> </tr> <tr> <td><code>version</code></td> <td>O</td> <td>If present shall be empty, the value is ignored and set by the document registry.</td> </tr> </tbody> </table> <h2 id=publishing-a-ch-emed-epr-document>Publishing a CH-EMED-EPR document</h2> <p>This section details the specific rules to follow when publishing <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/ >CH-EMED-EPR documents</a>.</p> <p>Only <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/document_mtp.html>MTP</a>, <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/document_pre.html>PRE</a>, <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/document_dis.html>DIS</a> and <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/document_padv.html>PADV</a> docs can be published. <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/document_pml.html>PML</a> and <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/document_pmlc.html>PMLC</a> can only be retrieved from the service.</p> <h3 id=referencing-external-documents>Referencing external documents</h3> <p>When publishing CH-EMED-EPR documents, all references (from the key elements) shall be known to the eMedication service. All non-key elements are ignored by the eMedication service. </p> <p>This implies that the metadata cannot contain <a href=https://profiles.ihe.net/ITI/TF/Volume3/ch-4.2.html#4.2.3.2.28>Reference ids</a>. This option is not supported, and submission of a reference to an existing document is forbidden.</p> <h3 id=creation-times>Creation times</h3> <p><a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/StructureDefinition-ch-emed-epr-composition-medicationtreatmentplan-definitions.html#Composition.date>Creation time</a> of a document must be equal or greater than the creation time of the last document of the treatment chain, ie. the last published document targeting the treatment (either the original MTP if no other document, or the last document published referencing this treatment).</p> <ul> <li>Creation time of the document has to be in the past.</li> <li>All references to other documents or items have to refer to existing approved non deleted documents.</li> </ul> <h3 id=rules-for-each-type-of-document>Rules for each type of document</h3> <h4 id=pre>PRE</h4> <ul> <li>Each PRE item should <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/StructureDefinition-ch-emed-epr-document-medicationprescription.html>refer to an MTP item</a> (<code>CHEMEDEPRMedicationRequest.treatmentplan</code>) that must:<ul> <li>Exist (has already been published, and never deleted)</li> <li>Be <a href=https://profiles.ihe.net/ITI/TF/Volume3/ch-4.2.html#4.2.3.2.2>approved</a>, ie. <code>DocumentEntry.availabilityStatus = approved</code>, </li> <li>Preferably be valid, i.e. the submission date should be within the <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/StructureDefinition-ch-emed-epr-dosage.html>MTP <code>dosage</code>&rsquo;s</a> <code>boundsPeriod</code> (<code>CHEMEDEPRDosage.repeat.bounds</code>).<ul> <li>If the <code>boundsPeriod</code> is not defined, the entry is considered to be always active.</li> <li>If only a <a href=http://hl7.org/fhir/R4/datatypes-definitions.html#Period.start><code>startDate</code></a> is specified, the MTP is considered to be active if the current date is after that date.</li> </ul> </li> <li>Active, ie. <code>CHEMEDEPRDocumentMedicationTreatmentPlan.CHEMEDEPRMedicationStatement.status = active</code></li> <li>For the same patient.</li> </ul> </li> <li>Code of <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/StructureDefinition-ch-emed-epr-medication.html>medication</a> should match the code of medication of the <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/StructureDefinition-ch-emed-epr-document-medicationprescription.html>MTP referenced by the PRE</a> (<code>CHEMEDEPRMedicationRequest.treatmentplan</code>). <em>This rule is not enforced and might be extended in the future</em>. </li> <li>If <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/StructureDefinition-ch-emed-epr-medication.html>lot number</a> (<code>CHEMEDEPRMedication.batch</code>) is specified in referenced MTP, <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/StructureDefinition-ch-emed-epr-medicationrequest.html>the one in the PRE</a> (<code>CHEMEDEPRMedicationRequest.medication[x]:medicationReference.batch</code>) should match it. <em>This rule is not enforced and might be extended in the future</em>.</li> </ul> <h4 id=padv>PADV</h4> <h5 id=padv-against-a-provisional-pre>PADV against a provisional PRE</h5> <p>A &ldquo;provisional PRE&rdquo; is a prescription for which the <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/StructureDefinition-ch-emed-epr-medicationrequest.html><code>CHEMEDEPRMedicationRequest.status</code></a> is <code>SUBMITTED</code> or <code>PROVISIONAL</code> and for which a <code>PADV</code> <code>OK</code> has not been completed yet.</p> <ul> <li>Medication cannot be changed. <em>This rule is not enforced and might be extended in the future</em>.</li> <li>Dosage instructions cannot be changed. <em>This rule is not enforced and might be extended in the future</em>.</li> <li>Substitution cannot be disallowed if the existing dispense includes one. <em>This rule is not enforced and might be extended in the future</em>.</li> <li>Observation code <code>REFUSE</code> cannot be issued.</li> </ul> <h5 id=padv-cancel>PADV CANCEL</h5> <ul> <li>Sets status to <code>CANCELED</code>.</li> <li>Not allowed against <code>DIS</code> or other <code>PADV</code> documents.</li> </ul> <h6 id=against-mtp>Against MTP</h6> <ul> <li>Also set related prescriptions&rsquo; status to <code>CANCELED</code> if their status was not already <code>REFUSED</code> or <code>CANCELED</code>.</li> <li>Treatment plan status must be <code>ACTIVE</code> or <code>SUSPENDED</code>.</li> </ul> <h6 id=against-pre>Against PRE</h6> <ul> <li>Not allowed for prescriptions whose status is already <code>CANCELED</code> or <code>REFUSED</code>.</li> <li>Not allowed to target anything else than <code>MTP</code> or <code>PRE</code></li> </ul> <h5 id=padv-ok>PADV OK</h5> <ul> <li>Sets targeted <code>MTP</code> or <code>PRE</code> status to <code>ACTIVE</code>.</li> <li>Against <code>MTP</code>: only allowed for treatment plans with status <code>ACTIVE</code> or <code>SUSPENDED</code>.</li> <li>Against <code>PRE</code>: only allowed for prescriptions with status <code>SUBMITTED</code> or <code>PROVISIONAL</code>.</li> <li><code>PADV OK</code> cannot target anything else than <code>MTP</code> or <code>PRE</code>.</li> </ul> <h5 id=padv-change>PADV CHANGE</h5> <ul> <li>Changes the treatment plan or prescription.</li> <li>Can only target <code>MTP</code> or <code>PRE</code>.</li> </ul> <h6 id=against-mtp_1>Against MTP</h6> <ul> <li>The treatment status must be <code>ACTIVE</code> or <code>SUSPENDED</code>.</li> <li>The treatment must not have been prescribed.</li> <li>Additionally, the treatment&rsquo;s status is set to <code>ACTIVE</code> as a result of the aggregation.</li> </ul> <h5 id=against-pre_1>Against PRE</h5> <ul> <li>The prescription&rsquo;s status must not be <code>CANCELED</code> or <code>REFUSED</code>.</li> <li>If the prescription&rsquo;s status is <code>SUBMITTED</code>, the aggregation sets it to <code>ACTIVE</code> as a result.</li> </ul> <h5 id=padv-refuse>PADV REFUSE</h5> <ul> <li>Sets status to <code>REFUSED</code>.</li> </ul> <h6 id=against-mtp_2>Against MTP</h6> <ul> <li>Sets also related prescriptions&rsquo; status to <code>REFUSED</code> if the status was not already <code>REFUSED</code> or <code>CANCELED</code>.</li> <li>Treatment&rsquo;s status must be <code>ACTIVE</code> or <code>SUSPENDED</code>.</li> </ul> <h6 id=against-pre_2>Against PRE</h6> <ul> <li>The prescription&rsquo;s status must not be <code>REFUSED</code>, <code>CANCELED</code> or <code>PROVISIONAL</code>.</li> <li>Cannot target anything else than <code>MTP</code> or <code>PRE</code>.</li> </ul> <h5 id=padv-suspend>PADV SUSPEND</h5> <ul> <li>Sets status to <code>SUSPENDED</code></li> <li>Only allowed to target <code>MTP</code> entries</li> <li>The treatment status must be <code>ACTIVE</code></li> </ul> <h5 id=padv-comment>PADV COMMENT:</h5> <ul> <li>Can target <code>MTP</code>, <code>PRE</code> and <code>DIS</code> entries only.</li> </ul> <h4 id=dis>DIS</h4> <ul> <li>If <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/StructureDefinition-ch-emed-epr-medication.html>lot number</a> (<code>batch</code>) is specified in referenced <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/StructureDefinition-ch-emed-epr-medicationdispense.html>MTP(<code>treatmentPlan</code>) or PRE (<code>prescription</code>)</a>, then it should match the one in the DIS if substitution is not allowed. <em>This rule is not enforced and might be extended in the future</em>.</li> </ul> <h5 id=dis-against-mtp-or-pre-mtp>DIS against MTP or PRE + MTP:</h5> <ul> <li>Medication should not be different if substitution is not allowed by PRE. <em>This rule might be extended in the future</em>. </li> <li>Dispense should not occur after the end of validity of the PRE document. <em>This rule might be extended in the future</em>.</li> <li>Dispense should not occur after the end of the treatment if specified in the prescription item. <em>This rule might be extended in the future</em>.</li> <li>If referenced PRE is not provisional, it should be <code>dispensable</code> (that is have status either <code>PROVISIONAL</code> or <code>ACTIVE</code>). <em>This rule is not enforced and might be extended in the future</em>.</li> <li>List of active <a href=https://build.fhir.org/ig/hl7ch/ch-emed//StructureDefinition-ch-emed-medication-medicationdispense-definitions.html#Medication.ingredient>ingredients</a> should be the same than the one in the referenced <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/StructureDefinition-ch-emed-epr-medicationdispense.html>PRE</a> (<code>prescription</code>). <em>This rule is not enforced and might be extended in the future</em>.</li> <li>If the treatment has been prescribed (at least one PRE document has been successfully submitted for it), then any DIS document targeting this treatment must reference one of its prescriptions as well.</li> </ul> <h3 id=roles>Roles</h3> <ul> <li><a href=http://fhir.ch/ig/ch-epr-term/2.0.9/CodeSystem-2.16.756.5.30.1.127.3.10.6.html#2.16.756.5.30.1.127.3.10.6-PAT>Patients</a> and their <a href=http://fhir.ch/ig/ch-epr-term/2.0.9/CodeSystem-2.16.756.5.30.1.127.3.10.6.html#2.16.756.5.30.1.127.3.10.6-REP>representatives</a> are allowed to publish only the following type of docs:<ul> <li>MTP</li> <li>PADV with a <code>COMMENT</code> observation code with no restriction.</li> <li>PADV with any other observation code only when referencing a document published by the same patient or a representative of the same patient. </li> </ul> </li> <li><a href=http://fhir.ch/ig/ch-epr-term/2.0.9/CodeSystem-2.16.756.5.30.1.127.3.10.6.html#2.16.756.5.30.1.127.3.10.6-HCP>Healthcare professionals</a> are allowed to publish only the following types of docs:<ul> <li>MTP</li> <li>PRE</li> <li>DIS</li> <li>PADV </li> </ul> </li> </ul> <h3 id=metadata-values-check>Metadata values check</h3> <p>Some values from the DocumentEntry are checked against the document (values in metadata and document must be equal):</p> <table> <thead> <tr> <th>DocumentEntry</th> <th>CH-EMED-EPR</th> </tr> </thead> <tbody> <tr> <td>author</td> <td><code>Composition.author</code></td> </tr> <tr> <td>classCode</td> <td><code>Composition.type</code>. Must be consistent with the document type (see <a href=#ClassCode-metadata-to-use-for-each-document-type>below</a>)</td> </tr> <tr> <td>creationTime</td> <td><code>Composition.date</code></td> </tr> <tr> <td>formatCode</td> <td>Must be consistent with the document type (see <a href=#ClassCode-metadata-to-use-for-each-document-type>below</a>)</td> </tr> <tr> <td>languageCode</td> <td><code>Composition.language</code></td> </tr> <tr> <td>mimeType</td> <td><code>application/fhir+xml</code> or <code>application/fhir+json</code></td> </tr> <tr> <td>typeCode</td> <td>Must be consistent with the document type (see <a href=#ClassCode-metadata-to-use-for-each-document-type>below</a>)</td> </tr> <tr> <td>uniqueId</td> <td><code>Bundle.identifier.value</code> and <code>Composition.identifier.value</code></td> </tr> </tbody> </table> <h3 id=classcode-metadata-to-use-for-each-document-type>ClassCode metadata to use for each document type</h3> <table> <thead> <tr> <th>Document type</th> <th>DocumentEntry.classCode</th> <th>DocumentEntry.formatCode</th> <th>DocumentEntry.typeCode</th> </tr> </thead> <tbody> <tr> <td>MTP</td> <td><code>440545006</code> <em>Prescription record</em></td> <td><code>urn:che:epr:ch-emed:mtp:2022</code></td> <td><code>761931002</code> <em>Medication treatment plan report (record artifact)</em></td> </tr> <tr> <td>PRE</td> <td><code>440545006</code> <em>Prescription record</em></td> <td><code>urn:che:epr:ch-emed:pre:2022</code></td> <td><code>761938008</code> <em>Medicinal Prescription record (record artifact)</em></td> </tr> <tr> <td>DIS</td> <td><code>440545006</code> <em>Prescription record</em></td> <td><code>urn:che:epr:ch-emed:dis:2022</code></td> <td><code>294121000195110</code> <em>Medication dispense document (record artifact)</em></td> </tr> <tr> <td>PADV</td> <td><code>440545006</code> <em>Prescription record</em></td> <td><code>urn:che:epr:ch-emed:padv:2022</code></td> <td><code>419891008</code> <em>Record artifact</em></td> </tr> <tr> <td>PML</td> <td><code>422735006</code> <em>Summary clinical document</em></td> <td><code>urn:che:epr:ch-emed:pml:2022</code></td> <td><code>721912009</code> <em>Medication summary document</em></td> </tr> <tr> <td>PMLC</td> <td><code>422735006</code> <em>Summary clinical document</em></td> <td><code>urn:che:epr:ch-emed:medication-card:2022</code></td> <td><code>736378000</code> <em>Medication management plan (record artifact)</em></td> </tr> </tbody> </table> <p>The class and type codes are from the SNOMED CT system: <code>2.16.840.1.113883.6.96</code>. The system for the <a href=http://www.fhir.org/guides/stats/codesystem-ch.fhir.ig.ch-epr-term-2.16.756.5.30.1.127.3.10.10.html><code>formatCode</code></a> is <code>2.16.756.5.30.1.127.3.10.10</code></p> <h2 id=replacing-a-ch-emed-epr-document>Replacing a CH-EMED-EPR document</h2> <p>The following rules must be observed when replacing a document :</p> <ul> <li><a href=http://fhir.ch/ig/ch-epr-term/2.0.9/CodeSystem-2.16.756.5.30.1.127.3.10.6.html#2.16.756.5.30.1.127.3.10.6-PAT>Patients</a> and their <a href=http://fhir.ch/ig/ch-epr-term/2.0.9/CodeSystem-2.16.756.5.30.1.127.3.10.6.html#2.16.756.5.30.1.127.3.10.6-REP>representatives</a> can only replace a document published by the same patient.<ul> <li>representatives are not supported by the service yet.</li> </ul> </li> <li><a href=http://fhir.ch/ig/ch-epr-term/2.0.9/CodeSystem-2.16.756.5.30.1.127.3.10.6.html#2.16.756.5.30.1.127.3.10.6-HCP>Healthcare professionals</a> (HCP) can only replace a document published by himself or by another HCP of same community of affiliation.<ul> <li>Current implementation: an HCP can replace a document published by any other HCP. Further rules and possible implementations are under discussion.</li> </ul> </li> <li><a href=https://fhir.ch/ig/ch-epr-term/2.0.9/CodeSystem-2.16.756.5.30.1.127.3.10.6.html>Document administrator</a> may only replace a document published by an HCP of the same community of affiliation.<ul> <li>Not implemented in PMP, to be discussed, for now a document admin can replace any document.</li> </ul> </li> <li>Replacing and replaced documents have to be of the same type (e.g. both MTP documents).</li> <li>Replacing and replaced documents have to refer to the same patient.</li> <li>Only documents at the end of a treatment chain can be replaced.</li> <li>Replaced document must exist in the repository.</li> <li>A replacement document must can be linked only to elements of the same medication chain. In case a PRE document is replaced, it may be linked only to elements of the medication chain of the referenced MTP. </li> <li><a href=https://fhir.ch/ig/ch-epr-term/2.0.9/CodeSystem-2.16.756.5.30.1.127.3.10.6.html>Document administrator</a> can replace any document regardless of who published it.</li> <li>Replaced document must be approved (although this is always the case after an initial ITI-41 transaction, documents might become <code>deprecated</code> after another ITI-41 transaction with a <a href=(https://profiles.ihe.net/ITI/TF/Volume3/ch-4.1.html#4.1.2.2)>replacement association</a>).</li> <li>Replaced document must not have <code>deletionStatus = deletionRequested</code> (this is relevant since although it is not the case at the moment with the current implementation, there might be files in the repository flagged for deletion but not deleted yet).</li> </ul> <h2 id=publishing-a-pmp-appc-document>Publishing a PMP-APPC document</h2> <p>This section details the rules applicable to metadata when publishing <a href=https://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_APPC.pdf>APPC documents</a>.</p> <h3 id=rules-for-appc>Rules for APPC:</h3> <ul> <li>Only <a href=http://fhir.ch/ig/ch-epr-term/2.0.9/CodeSystem-2.16.756.5.30.1.127.3.10.6.html#2.16.756.5.30.1.127.3.10.6-PAT>Patients</a> and their <a href=http://fhir.ch/ig/ch-epr-term/2.0.9/CodeSystem-2.16.756.5.30.1.127.3.10.6.html#2.16.756.5.30.1.127.3.10.6-REP>representatives</a> or policy administrators can publish a new APPC document.<ul> <li>representatives are not supported by the service yet.</li> </ul> </li> <li>Only <a href=http://fhir.ch/ig/ch-epr-term/2.0.9/CodeSystem-2.16.756.5.30.1.127.3.10.6.html#2.16.756.5.30.1.127.3.10.6-PAT>Patients</a> and their <a href=http://fhir.ch/ig/ch-epr-term/2.0.9/CodeSystem-2.16.756.5.30.1.127.3.10.6.html#2.16.756.5.30.1.127.3.10.6-REP>representatives</a> can replace their own APPC documents (if it exists).<ul> <li>representatives are not supported by the service yet.</li> </ul> </li> <li>Policy administrators of the reference community of the patient can replace any existing APPC document.</li> <li>No APPC for the specified patient exists in the system (unless the published document is a replacement), otherwise the document is refused.</li> <li>As for <a href=#Replacing_a_CH-EMED-EPR_document>CH-EMED-EPR</a>, APPC documents to be replaced must:<ul> <li>Be approved (as before, this is always the case for documents in the PMP repository when they are published, but their status might change to deprecated after a replacement).</li> <li>Not have <code>deletionStatus = deletionRequested</code>.</li> </ul> </li> <li>APPC document structure is described in <a href=https://www.e-health-suisse.ch/fileadmin/user_upload/Dokumente/E/Implementation_Guide_eMedication_Architecture_Specs_013_Anhoerung.pdf>Implementation Guide for eMedication architecture in the context of the EPR</a>, section ยง7.5<ul> <li><code>1 Description</code> section for free text description of the policy set</li> <li><code>1 Target</code> section containing:<ul> <li><code>1 Resources</code> section containing <code>1 Resource</code> object pointing to the patient by indicating the <code>EPR-SPID</code>.</li> <li><code>* Subjects</code> sections each one containing themselves <code>Subject</code> entries each defining 1 &ldquo;who&rdquo;. Subject cannot be the patient.</li> <li><code>* Environments</code> sections each one containing one <code>Environment</code> object limiting the validity period of the policy.<ul> <li>Required if at least one <code>Subject</code> refers to an organization or group.<ul> <li>Specs state &ldquo;This section will not be used within this context.&rdquo;</li> </ul> </li> </ul> </li> <li>A list of <code>PolicyIdReference</code> or <code>PolicySetIdReference</code> defining the level of access granted to the users identified by the Subjects section.<ul> <li>See 7.5 for the list of policies that can be used.</li> </ul> </li> <li><code>*</code> embedded <code>PolicySet</code> sections containing:<ul> <li><code>1..* Subjects</code> sections containing themselves <code>Subject entries</code> and each defines one &ldquo;who&rdquo;.</li> <li><code>* Environments</code> (same as above)</li> </ul> </li> </ul> </li> </ul> </li> </ul> <h3 id=appc-metadata>APPC metadata</h3> <table> <thead> <tr> <th>DocumentEntry</th> <th>APPC</th> </tr> </thead> <tbody> <tr> <td>classCode</td> <td><code>371537001</code> <em>Consent report (record artifact)</em></td> </tr> <tr> <td>formatCode</td> <td><code>urn:ihe:iti:appc:2016:consent</code></td> </tr> <tr> <td>mimeType</td> <td><code>text/xml</code></td> </tr> <tr> <td>serviceStartTime</td> <td>None</td> </tr> <tr> <td>serviceStopTime</td> <td>None</td> </tr> <tr> <td>typeCode</td> <td><code>419891008</code> <em>Record artifact</em></td> </tr> </tbody> </table> <hr> <div class="md-source-file last-edited"> <svg xmlns=http://www.w3.org/2000/svg class="icon icon-tabler icon-tabler-clock-edit" width=24 height=24 viewbox="0 0 24 24" stroke-width=2 stroke=currentColor fill=none stroke-linecap=round stroke-linejoin=round> <path stroke=none d="M0 0h24v24H0z" fill=none></path> <path d="M21 12a9.001 9.001 0 1 0 -9.972 8.948c.32 .034 .644 .052 .972 .052"></path> <path d="M12 7v5l2 2"></path> <path d="M18.42 15.61a2.1 2.1 0 0 1 2.97 2.97l-3.39 3.42h-3v-3l3.42 -3.39z"></path> </svg> This page was updated <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2023-10-04T12:51:29+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2023-10-04</span> </div> </article> </div> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.tabs", "navigation.indexes", "toc.integrate", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../assets/javascripts/bundle.2a6f1dda.min.js></script> <script src=../../js/timeago.min.js></script> <script src=../../js/timeago_mkdocs_material.js></script> </body> </html>