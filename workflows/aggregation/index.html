<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Quentin Ligier"><link href=https://qligier.github.io/cara-emed-ig/workflows/aggregation/ rel=canonical><link href=../situationalworkflows/ rel=prev><link href=../../emed/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.0, mkdocs-material-9.0.15"><title>Aggregation - CARA's eMedication IG</title><link rel=stylesheet href=../../assets/stylesheets/main.113286f1.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.a0c5b2b5.min.css><link rel=stylesheet href=../../css/timeago.css><link rel=stylesheet href=../../stylesheets/cara.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=blue data-md-color-accent> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#aggregation class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="CARA's eMedication IG" class="md-header__button md-logo" aria-label="CARA's eMedication IG" data-md-component=logo> <img src=../../assets/cara.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> CARA's eMedication IG </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Aggregation </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=blue data-md-color-accent aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=blue data-md-color-accent aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> </form> <div class=md-header__source> <a href=https://github.com/qligier/cara-emed-ig title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../transactions/ class=md-tabs__link> Transactions </a> </li> <li class=md-tabs__item> <a href=../ class="md-tabs__link md-tabs__link--active"> Workflows </a> </li> <li class=md-tabs__item> <a href=../../emed/ class=md-tabs__link> CH-EMED-EPR </a> </li> <li class=md-tabs__item> <a href=../../appc/ class=md-tabs__link> PMP-APPC </a> </li> <li class=md-tabs__item> <a href=../../endpoints/ class=md-tabs__link> EndPoints </a> </li> <li class=md-tabs__item> <a href=../../oids/ class=md-tabs__link> OIDs </a> </li> <li class=md-tabs__item> <a href=../../other/upcoming_changes/ class=md-tabs__link> Upcoming Changes </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="CARA's eMedication IG" class="md-nav__button md-logo" aria-label="CARA's eMedication IG" data-md-component=logo> <img src=../../assets/cara.svg alt=logo> </a> CARA's eMedication IG </label> <div class=md-nav__source> <a href=https://github.com/qligier/cara-emed-ig title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <div class="md-nav__link md-nav__link--index "> <a href=../../transactions/ >Transactions</a> <label for=__nav_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Transactions </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../transactions/documents/ class=md-nav__link> Documents </a> </li> <li class=md-nav__item> <a href=../../transactions/auth/ class=md-nav__link> Auth </a> </li> <li class=md-nav__item> <a href=../../transactions/iti41/ class=md-nav__link> XDS: publish documents (ITI-41) </a> </li> <li class=md-nav__item> <a href=../../transactions/iti43/ class=md-nav__link> XDS: retrieve documents (ITI-43) </a> </li> <li class=md-nav__item> <a href=../../transactions/iti18/ class=md-nav__link> XDS: search documents (ITI-18) </a> </li> <li class=md-nav__item> <a href=../../transactions/iti57/ class=md-nav__link> XDS: delete documents (ITI-57) </a> </li> <li class=md-nav__item> <a href=../../transactions/chpharm1/ class=md-nav__link> XDS: search pharmacy documents (CH:PHARM-1) </a> </li> <li class=md-nav__item> <a href=../../transactions/date_processing/ class=md-nav__link> Date processing </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <div class="md-nav__link md-nav__link--index "> <a href=../ >Workflows</a> <label for=__nav_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Workflows </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../situationalworkflows/ class=md-nav__link> Situational workflows </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Aggregation <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Aggregation </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#concepts class=md-nav__link> Concepts </a> </li> <li class=md-nav__item> <a href=#triggers class=md-nav__link> Triggers </a> </li> <li class=md-nav__item> <a href=#scope class=md-nav__link> Scope </a> </li> <li class=md-nav__item> <a href=#aggregation-process class=md-nav__link> Aggregation process </a> <nav class=md-nav aria-label="Aggregation process"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#overview class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=#medication-card class=md-nav__link> Medication card </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../emed/ class=md-nav__link> CH-EMED-EPR </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <div class="md-nav__link md-nav__link--index "> <a href=../../appc/ >PMP-APPC</a> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> PMP-APPC </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> EndPoints <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> EndPoints </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../endpoints/ class=md-nav__link> Endpoints </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../oids/ class=md-nav__link> OIDs </a> </li> <li class=md-nav__item> <a href=../../other/upcoming_changes/ class=md-nav__link> Upcoming Changes </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=aggregation>Aggregation</h1> <h2 id=concepts>Concepts</h2> <table> <thead> <tr> <th>Term</th> <th>Definition</th> <th>References</th> </tr> </thead> <tbody> <tr> <td>Medication plan (current medication)</td> <td>The medication plan is the documentation of all the medication information for a patient at a certain point of time.<br>The medication plan can be presented as a <a href=https://github.com/ehealthsuisse/EPD-by-example/blob/main/files/MedicationCardDocument.md>medication card</a> or as an <a href=https://emediplan.ch/ >eMediplan</a> (eMediplan is not supported by the service, it is another way of displaying the medication plan).</td> <td>See <a href=https://www.ihe.net/uploadedFiles/Documents/Pharmacy/IHE_Pharmacy_Suppl_PML.pdf>IHE Pharmacy Community Medication List (PML)</a> and IPAG&rsquo;s definition (<a href=https://www.fmh.ch/files/pdf24/rapport-gtip-ipag-sur-la-cybermedication.pdf>FR</a>, <a href=https://www.fmh.ch/files/pdf24/ipag-bericht-emedikation.pdf>DE</a>), § 2.1 and § 2.5.</td> </tr> <tr> <td>Medication treatment</td> <td>A medication treatment corresponds to one single medication the patient was planned to take in the past or is planned to take presently or in the future, including its name, dosage, frequency of intake, etc.<br>Medication treatments are created every time an <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/document_mtp.html>MTP document</a> is received.<br> This service considers two kinds of medication treatments: &ldquo;simple&rdquo; and &ldquo;prescribed&rdquo;.<br> Simple medication treatments are created with just one <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/document_mtp.html>MTP document</a> (by the patient or a healthcare professional).<br> Prescribed medication treatments are created by healthcare professionals only, with an <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/document_mtp.html>MTP document</a> followed by a <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/document_pre.html>PRE document</a>.</td> <td>See <a href=https://www.ihe.net/uploadedFiles/Documents/Pharmacy/IHE_Pharmacy_Suppl_MTP.pdf>IHE Pharmacy MTP supplement</a>, as well as <a href=https://build.fhir.org/ig/hl7ch/ch-emed//medication-treatment-plan-document.html>HL7&rsquo;s Medication Treatment Plan FHIR document</a>.</td> </tr> <tr> <td>Medication treatment instance</td> <td>A medication treatment instance is a concept of this eMedication service.<br> A medication treatment can change over time: the dosage, medication, active substance, comments, etc. can be updated.<br> The medication treatment instance represents the state of a medication at a current point of time. <br>Medication treatment instance creation depends on the type of medication treatment. For &ldquo;simple&rdquo; (ie. not prescribed) treatments, a single medication treatment instance is created when the <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/document_mtp.html>MTP document</a> is received. <br> For <em>prescribed</em> medication treatments (ie. medication treatments for which there is a <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/document_mtp.html>MTP document</a> and at least one <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/document_pre.html>PRE document</a>), a new instance is created every time a <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/document_pre.html>PRE document</a> is received.<br>Each medication treatment instance appears in a single line within the medication card. Instances associated with the same treatment are visually grouped.</td> <td>-</td> </tr> <tr> <td>Medication statement</td> <td>A medication statement represents a given medication (form, dosage, GTIN/ATC, ingredients etc.)</td> <td>See the <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/StructureDefinition-ch-emed-epr-medicationstatement-treatmentplan.html>definition in the implementation guide</a>.</td> </tr> <tr> <td>Aggregation</td> <td>The aggregation is the process of determining the current state of each medication treatment within a patient&rsquo;s medication plan, based on the existing medication treatment instances.<br>This is done depending on the document triggering the aggregation, either by updating existing medication treatments / medication treatment instances, or by creating new medication treatment instances</td> <td>-</td> </tr> </tbody> </table> <h2 id=triggers>Triggers</h2> <p>Aggregation occurs when:</p> <ul> <li>A new <a href=../../emed/ >emed document</a> is provided via the <a href=../../transactions/iti41/ >ITI-41 transaction</a>.</li> <li>An <a href=../../emed/ >emed document</a> is removed via the <a href=../../transactions/iti57/ >ITI-57 transaction</a>.</li> <li>An <a href=../../emed/ >emed document</a> is replaced via the <a href=../../transactions/iti41/ >ITI-41 transaction</a> and the <a href=https://profiles.ihe.net/ITI/TF/Volume3/ch-4.1.html#4.1.2.2>replace</a> association.</li> </ul> <h2 id=scope>Scope</h2> <p>When triggered, aggregation occurs for the medication treatment referenced by the triggering document.</p> <p>When the triggering document is a <a href=https://build.fhir.org/ig/CARA-ch/ch-emed-epr/document_pre.html>PRE</a>, it might reference several medication treatments (multi-prescription). In this case the service applies the aggregation process to each referenced medication treatment.</p> <h2 id=aggregation-process>Aggregation process</h2> <h3 id=overview>Overview</h3> <p>The table below shows an overview of the elements updated or created during the aggregation process.</p> <html> <head><style>
    html {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif, -apple-system, BlinkMacSystemFont;
      color:black;
    }

    td {
      padding: 5px;
    }

    .header0 {
      text-align: right;
      font-style: italic;
    }

    .header1 {
      background-color: rgb(47, 117, 191);
      text-align: center;
      color: white;
      font-weight: bold;
    }

    .header2 {
      background-color: rgb(155, 194, 230);
      text-align: center;
      font-weight: bold;
      border: none;
    }

    .header3 {
      background-color: rgb(189, 215, 238);
      text-align: center;
      font-style: italic;
    }

    .header4 {
      background-color: rgb(221, 235, 247);
    }

    .ref {
      background-color: rgb(237, 125, 49);
      color: white;
      font-weight: bold;
      text-align: center;
    }

    .none {
      background-color: rgb(217, 217, 217);
      text-align: center;
    }

    .add {
      background-color: rgb(226, 239, 218);
      text-align: center;
    }

    .update {
      background-color: rgb(236, 217, 255);
      text-align: center;
    }

    .check {
      background-color: rgb(255, 242, 204);
      text-align: center;
    }
  </style></head> <body> <table> <tr> <td colspan=4 class=header0>Document triggering the aggregation</td> <td rowspan=3 class=header1>MTP</td> <td rowspan=3 class=header1>PRE</td> <td rowspan=3 class=header1>DIS</td> <td colspan=11 class=header1>PADV</td> </tr> <tr> <td></td> <td rowspan=2 class=header2>Attribute</td> <td rowspan=2 class=header2>Description</td> <td rowspan=2 class=header2>Reference on medication card</td> <td colspan=2 class=header1>COMMENT</td> <td colspan=2 class=header1>OK</td> <td class=header1>SUSPEND</td> <td colspan=2 class=header1>CHANGE</td> <td colspan=2 class=header1>CANCEL</td> <td colspan=2 class=header1>REFUSE</td> </tr> <tr> <td></td> <td class=header1>Target MTP</td> <td class=header1>Target any other document</td> <td class=header1>Target MTP</td> <td class=header1>Target PRE</td> <td class=header1>Can only target MTP</td> <td class=header1>Target MTP</td> <td class=header1>Target PRE</td> <td class=header1>Target MTP</td> <td class=header1>Target PRE</td> <td class=header1>Target MTP</td> <td class=header1>Target PRE</td> </tr> <tr> <td rowspan=10 class=header1>Medication treatment</td> <td colspan=3 class=header3>Operation</td> <td class=header3>Create new Medication Treatment.</td> <td class=header3>Retrieve instance(s) associated with referenced treatment and patient.</td> <td class=header3>Retrieve instance associated with referenced treatment and patient. <br> Validate that the incoming dispense references a prescription if the medication treatment is in prescribed state.</td> <td colspan=11 class=header3>Retrieve instance associated with referenced treatment and patient.</td> </tr> <tr> <td class=header4>comments</td> <td class=header4>The list of comments made on the treatment itself (referencing the MTP entry). Prescription comments will be recorded on the medication treatment instance.</td> <td class=ref>7</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=add>Add comment from PADV.</td> <td class=none>-</td> <td class=add>Add comment from PADV.</td> <td class=none>-</td> <td class=add>Add comment from PADV.</td> <td class=add>Add comment from PADV.</td> <td class=none>-</td> <td class=add>Add comment from PADV.</td> <td class=none>-</td> <td class=add>Add comment from PADV.</td> <td class=none>-</td> </tr> <tr> <td class=header4>dispenses</td> <td class=header4>The list of dispenses targeting the MTP associated with this treatment, or any of its related PRE.</td> <td class=ref>-</td> <td class=none>-</td> <td class=none>-</td> <td class=add>Add new dispense entry referencing incoming DIS document.</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> </tr> <tr> <td class=header4>instances</td> <td class=header4>The list of medication treatment instances associated with this medication treatment.</td> <td class=ref>-</td> <td class=add>Add new instance.</td> <td class=add>Add new instance if the treatment is &quot;prescribed&quot; (ie. There is already a Medication treatment instance related to a PRE associated with this medication treatment).</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> </tr> <tr> <td class=header4>id</td> <td class=header4>Globally unique id of this medication treatment.</td> <td class=ref>-</td> <td class=add>Initialize withg MTP treatment id.</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> </tr> <tr> <td class=header4>mpiPid</td> <td class=header4>Reference to patient.</td> <td class=ref>1</td> <td class=add>Initialize with MTP's patient reference.</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> </tr> <tr> <td class=header4>mtpReference</td> <td class=header4>Reference to the MTP associated with this medication treatment.</td> <td class=ref>4</td> <td class=add>Initialize with reference to incoming MTP.</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> </tr> <tr> <td class=header4>status</td> <td class=header4>Status of the treatment. Can be active, suspended, canceled or refused.<br> The status is not shown on the medication card, it is used to select the treatments to display.</td> <td class=ref>-</td> <td class=add>Initialize &quot;active&quot;.</td> <td class=check>Check value: must be active (not updated).</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=update>Set &quot;active&quot; if it was &quot;active&quot; or &quot;suspended&quot;.</td> <td class=none>-</td> <td class=update>Set to &quot;suspended&quot; document referenced by PADV is a MTP and if it was in &quot;active&quot; state.</td> <td class=update>Set &quot;active&quot; if previous value was &quot;active&quot; or &quot;suspended&quot;.</td> <td class=none>-</td> <td class=update>Set &quot;cancel&quot; if previous value was not &quot;active&quot; or &quot;suspended&quot;.</td> <td class=none>-</td> <td class=update>Set &quot;refused&quot; if previous value was not &quot;active&quot; or &quot;suspended&quot;.</td> <td class=none>-</td> </tr> <tr> <td class=header4>startDate</td> <td class=header4>The date of the beginning of the treatment. Can be the dosage start date if it is defined, or the MTP effective time.</td> <td class=ref>-</td> <td class=add>Initialize with the MTP's effective periode start time if defined, with the creation date of the MTP document otherwise.</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> </tr> <tr> <td class=header4>stopDate</td> <td class=header4>The date at which the treatment was stopped (canceled or refused).</td> <td class=ref>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=update>Set PADV document date</td> <td class=none>-</td> <td class=update>Set PADV document date</td> <td class=none>-</td> </tr> <tr> <td rowspan=17 class=header1>Medication treatment instance</td> <td colspan=3 class=header3>Operation</td> <td class=header3>Create new Medication Treatment instance.</td> <td class=header3> <ul> <li>Retrieve existing Medication Treatment instance if treatment is &quot;simple&quot; (ie. This is the first PRE for this treatment).</li> <li>Create new Medication Treatment instance if treatment is &quot;prescribed&quot; (ie. There is already a PRE for this treatment).</li> </ul> </td> <td class=header3> <ul> <li>If incoming DIS is associated with a prescription, retrieve the medication treatment instance of the medication treatment, associated with the DIS's prescription.</li> <li>The first medication treatment instance of this medication treatment otherwise (ensure it exists).</li> </ul> </td> <td class=header3>-</td> <td class=header3>Retrieve existing medication treatment instance associated with PADV target document.</td> <td class=header3>-</td> <td class=header3>Retrieve existing medication treatment instance associated with PADV's target PRE.</td> <td class=header3>-</td> <td class=header3>Retrieves first medication treatment instance associated with target MTP.</td> <td class=header3>Retrieves instance associated with PADV's medication request if PADV targets a PRE.</td> <td class=header3>Retrieves all instances associated with MTP's medication treatment.</td> <td class=header3>Retrieve existing medication treatment instance associated with PADV's target PRE.</td> <td class=header3>Retrieves all instances associated with MTP's medication treatment.</td> <td class=header3>-</td> </tr> <tr> <td class=header4>additionalDosages</td> <td class=header4>Additional entry of the dosage instruction.</td> <td class=ref>6</td> <td class=add>Initialize with incoming MTP's medication additional dosages.</td> <td class=update>Add PRE's medication request additional dosages.</td> <td class=update>Checks if existing dosage is equal to incoming DIS dosage. Update additional dosages with DIS's medication dispense additional dosages if necessary.</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=update>Set PADV's medication statement additional dosage.</td> <td class=update>Add PADV's medication statement additional dosage.</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> </tr> <tr> <td class=header4>comments</td> <td class=header4>The list of comments associated with this medication treatment instance (PADV referencing the PRE associated with this instance).</td> <td class=ref>7</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=add>Add PADV comment.</td> <td class=none>-</td> <td class=add>Add PADV comment.</td> <td class=none>-</td> <td class=none>-</td> <td class=add>Add PADV comment.</td> <td class=none>-</td> <td class=add>Add PADV comment.</td> <td class=none>-</td> <td class=add>Add PADV comment.</td> </tr> <tr> <td class=header4>entryReferences</td> <td class=header4>The list of entries (documents) that have been aggregated in this medication treatment instance.</td> <td class=ref>-</td> <td class=add>Initialize with reference to incoming MTP.</td> <td class=update>Add reference to incoming PRE.</td> <td class=update>Add reference to incoming DIS.</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> </tr> <tr> <td class=header4>baseDosage</td> <td class=header4>The dosage instruction for this instance.</td> <td class=ref>6<br> 5 (start and end date of dosage)</td> <td class=add>Initialize with incoming MTP's medication base dosage.</td> <td class=update>Set PRE's medication request base dosage.</td> <td class=update>Checks if existing dosage is equal to incoming DIS dosage. Update base dosage with DIS's medication dispense dosage if necessary.</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td colspan=2 class=update>Set PADV's medication statement base dosage.</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> </tr> <tr> <td class=header4>id</td> <td class=header4>Globally unique id of this medication treatment instance.</td> <td class=ref>-</td> <td class=add>Initialize with MTP treatment id.</td> <td class=update>Set PRE's medication request id.</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> </tr> <tr> <td class=header4>inReserve</td> <td class=header4>Flag indicating whether this treatment is in reserve or not.</td> <td class=ref>9</td> <td class=add>Initialize with value from MTP.</td> <td class=update>Set to PRE's medication request &quot;is as needed&quot; value.</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td colspan=2 class=update>Set PADV's medication as needed flag value.</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> </tr> <tr> <td class=header4>lastInterveningAuthor</td> <td class=header4>The author of the last item entry (of any kind) in this treatment. This is the last intervening.</td> <td class=ref>-</td> <td class=add>Initialize with MTP document author.</td> <td class=update>Set PRE document author.</td> <td class=update>Set DIS document author.</td> <td colspan=11 class=update>Set PADV document author.</td> </tr> <tr> <td class=header4>lastMedicalAuthor</td> <td class=header4>The author of the last item entry (of type MTP, PRE, or any type of PADV except COMMENT that apply to an MTP or PRE) in this treatment. This is the last &quot;medical&quot; participant.</td> <td class=ref>2</td> <td class=add>Initialize with MTP's medication statement entry author.</td> <td class=update>Set PRE medication request entry author.</td> <td class=update>Set DIS medication dispense author.</td> <td colspan=11 class=update>Set PADV comment author.</td> </tr> <tr> <td class=header4>medication</td> <td class=header4>The medication associated with this treatment.</td> <td class=ref>4</td> <td class=add>Initialize with incoming MTP medication.</td> <td class=update>Set medication from PRE's medication request.</td> <td class=update>Set medication from DIS's medication dispense.</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td colspan=2 class=update>Set PADV's medication.</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> </tr> <tr> <td class=header4>preReference</td> <td class=header4>Reference to the PRE document associated with this instance.</td> <td class=ref>-</td> <td class=none>-</td> <td class=update>Set reference to incoming PRE.</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> </tr> <tr> <td class=header4>preStartTime</td> <td class=header4>Prescription validity start time, inclusive (the first time the prescription may be dispensed).</td> <td class=ref>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> </tr> <tr> <td class=header4>preStopTime</td> <td class=header4>Prescription validity stop time, inclusive.<br> the last time the prescription may be dispensed. No limit is implemented in this service.</td> <td class=ref>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> </tr> <tr> <td class=header4>reason</td> <td class=header4>The reason for the treatment.</td> <td class=ref>7</td> <td class=add>Initialize with incoming MTP's medication reason code.</td> <td class=update>Set PRE's medication request reason code.</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td colspan=2 class=update>Set PADV's medication reason code.</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> </tr> <tr> <td class=header4>status</td> <td class=header4>The status of the prescription associated with this instance. Can be submitted, provisional, active, canceled or refused.<br> The status is not shown on the medication card, it is used to select the treatment instances to display.</td> <td class=ref>-</td> <td class=add>Initialize &quot;active&quot;.</td> <td class=update>Set &quot;submitted&quot;.</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=update>Set &quot;active&quot; current status is not &quot;submitted&quot; or &quot;provisional&quot;.</td> <td class=none>-</td> <td class=none>-</td> <td class=update>Set &quot;active&quot; if previous value was &quot;submitted&quot;.</td> <td colspan=2 class=update>Set &quot;cancel&quot; if previous value was not &quot;refused&quot;.</td> <td colspan=2 class=update>Set &quot;refused&quot; if previous value was not &quot;refused&quot;.</td> </tr> <tr> <td class=header4>stopDate</td> <td class=header4>The date at which the treatment instance was stopped (canceled or refused).</td> <td class=ref>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td colspan=2 class=update>Set PADV document date.</td> <td colspan=2 class=update>Set PADV document date.</td> </tr> <tr> <td class=header4>substitutionPermitted</td> <td class=header4>Flag indicating whether a substitute (generics) may be dispensed for this treatment or not.</td> <td class=ref>-</td> <td class=add>Initialize &quot;true&quot;.</td> <td class=update>Set to &quot;true&quot; if PRE's medication request &quot;resolve substitution&quot; attribute is &quot;equivalent&quot;.</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td colspan=2 class=update>Set to &quot;true&quot; if PADV's medication request &quot;resolve substitution&quot; attribute is &quot;equivalent&quot;.</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> <td class=none>-</td> </tr> </table> </body> </html> <h3 id=medication-card>Medication card</h3> <p><img alt="Medication card" src=../../assets/medicationcard.jpg></p> <hr> <div class="md-source-file last-edited"> <svg xmlns=http://www.w3.org/2000/svg class="icon icon-tabler icon-tabler-clock-edit" width=24 height=24 viewbox="0 0 24 24" stroke-width=2 stroke=currentColor fill=none stroke-linecap=round stroke-linejoin=round> <path stroke=none d="M0 0h24v24H0z" fill=none></path> <path d="M21 12a9.001 9.001 0 1 0 -9.972 8.948c.32 .034 .644 .052 .972 .052"></path> <path d="M12 7v5l2 2"></path> <path d="M18.42 15.61a2.1 2.1 0 0 1 2.97 2.97l-3.39 3.42h-3v-3l3.42 -3.39z"></path> </svg> This page was updated <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2023-12-08T10:23:35+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2023-12-08</span> </div> </article> </div> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.tabs", "navigation.indexes", "toc.integrate", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../assets/javascripts/bundle.2a6f1dda.min.js></script> <script src=../../js/timeago.min.js></script> <script src=../../js/timeago_mkdocs_material.js></script> </body> </html>